<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>第2回：VPC設計とEC2へのSSH接続 | 勉強会 for AWS</title>
    <link rel="stylesheet" href="../common/style.css" />
    <style>
      header .insider-header {
        max-width: 1160px;
      }
    </style>
  </head>

  <body>
    <header>
      <div class="insider-header">
        <a href="../index.html" class="logo"
          >勉強会 <span style="font-size: 0.8em">for</span> AWS</a
        >
        <span class="header-spacer"></span>
        <a href="../board/signin.html" class="header-btn">質問板</a>
      </div>
    </header>
    <main>
      <div class="container">
        <div class="content">
          <h1 id="title">第2回：VPC設計とEC2へのSSH接続</h1>
          <div class="post-date">Posted at 2025-07-20</div>
          <section id="introduction">
            <h2 id="introduction">はじめに</h2>
            <p>
              このセッションでは、AWSのVPC（Virtual Private Cloud）とEC2（Elastic Compute Cloud）の基本的な概念を学び、実際にVPCを構築し、EC2インスタンスを立ち上げてSSH接続するまでの流れを体験します。<br />
              VPCはAWSのネットワーク基盤であり、EC2は仮想サーバーを提供するサービスです。これらの理解は、AWSでのシステム設計や運用において非常に重要です。
            </p>
            <p>このセッションは以下の構成になっています</p>
            <ol>
              <li>VPCと構成要素</li>
              <li>ハンズオン: VPC作成</li>
              <li>EC2（仮想サーバー）の基礎</li>
              <li>ハンズオン: EC2インスタンスの作成とSSH接続</li>
            </ol>
            <p>ハンズオンの構成図は以下になります</p>
            <img
              src="../image/session/1/introduction.png"
              alt="AWS構成図"
              style="width: 100%; max-width: 400px; margin-top: 15px"
            />
          </section>

          <section id="vpc-overview">
            <h2 id="vpc-overview">1. VPCと構成要素</h2>
            <p>
              VPCはAWSのネットワーク基盤ですが、以下のようにさまざまな構成要素があり、それぞれが特定の役割を持っています。<br />
              これらの要素を理解することで、AWS上でのネットワーク設計やセキュリティ設定が可能になります。
            </p>
            <ul>
              <li>VPC</li>
              <li>サブネット</li>
              <li>インターネットゲートウェイ（IGW）</li>
              <li>ルートテーブル</li>
              <li>NATゲートウェイ</li>
              <li>セキュリティグループ（SG）</li>
              <li>ネットワークACL（NACL）</li>
              <li>Elastic IP（EIP）</li>
              <li>Elastic Network Interface（ENI）</li>
            </ul>

            <article class="vpc-block">
              <h3 id="vpc">VPC（Virtual Private Cloud）</h3>
              <p>
                Amazon
                VPCは、AWS内で自由に構築できる仮想的なネットワーク環境です。企業が自社専用ネットワークを構築するように、IPアドレス範囲やサブネット、ルート、セキュリティ設定などを柔軟に設計できます。
              </p>
              <img
                src="../image/session/1/vpc1.drawio.png"
                alt="vpc構成図"
                style="
                  width: 100%;
                  max-width: 200px;
                  display: block;
                  margin-top: 10px;
                "
              />
              <p
                style="
                  text-align: center;
                  font-size: 0.9em;
                  color: #555;
                  margin-top: 15px;
                "
              >
                VPCのみ作成した状態ではインターネットとは接続しておらず、VPC内は完全にプライベートな状態です
              </p>
              <p>
                VPCのネットワーク範囲はCIDR（Classless Inter-Domain
                Routing）で指定します。CIDRは、IPアドレスとサブネットマスクを一緒に記述する方法です。
              </p>
              <ul>
                <li>
                  例：10.0.0.0/16
                  （ネットワークアドレスは10.0.0.0、サブネットマスクは16ビット）
                </li>
              </ul>
              <p>
                VPCに使用するCIDRは以下の範囲に収まる値が推奨されています。<br />
                ハンズオンでは10.0.0.0/16を使用します。
              </p>
              <table
                style="border-collapse: collapse; width: 100%; max-width: 600px"
              >
                <thead>
                  <tr>
                    <th
                      style="
                        border: 1px solid #ccc;
                        padding: 8px;
                        background: #f2f2f2;
                      "
                    >
                      CIDR
                    </th>
                    <th
                      style="
                        border: 1px solid #ccc;
                        padding: 8px;
                        background: #f2f2f2;
                      "
                    >
                      IPアドレス範囲
                    </th>
                    <th
                      style="
                        border: 1px solid #ccc;
                        padding: 8px;
                        background: #f2f2f2;
                      "
                    >
                      IPアドレス数
                    </th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td style="border: 1px solid #ccc; padding: 8px">
                      <code>10.0.0.0/8</code>
                    </td>
                    <td style="border: 1px solid #ccc; padding: 8px">
                      <code>10.0.0.0 ～ 10.255.255.255</code>
                    </td>
                    <td style="border: 1px solid #ccc; padding: 8px">
                      約1,670万
                    </td>
                  </tr>
                  <tr>
                    <td style="border: 1px solid #ccc; padding: 8px">
                      <code>172.16.0.0/12</code>
                    </td>
                    <td style="border: 1px solid #ccc; padding: 8px">
                      <code>172.16.0.0 ～ 172.31.255.255</code>
                    </td>
                    <td style="border: 1px solid #ccc; padding: 8px">
                      約104万
                    </td>
                  </tr>
                  <tr>
                    <td style="border: 1px solid #ccc; padding: 8px">
                      <code>192.168.0.0/16</code>
                    </td>
                    <td style="border: 1px solid #ccc; padding: 8px">
                      <code>192.168.0.0 ～ 192.168.255.255</code>
                    </td>
                    <td style="border: 1px solid #ccc; padding: 8px">
                      約6.5万
                    </td>
                  </tr>
                </tbody>
              </table>
            </article>

            <article class="vpc-block">
              <h3 id="subnet">サブネット（Subnet）</h3>
              <p>
                VPCを小さく分割したネットワーク。EC2などのリソースはサブネット内に作成します。
              </p>
              <p>サブネットの図を挿入</p>
              <p>
                サブネットにも「10.0.1.0/24」、「10.0.2.0/24」などCIDRを指定します。VPCのCIDR範囲に収まる値を使用します。
              </p>
              <p>
                上記図の状態ではまだインターネットとサブネットはつながっていません。インターネットと繋がっていないサブネットはプライベートサブネットと呼ばれます。
              </p>
              <p>
                インターネットと接続するためには必要なものがいくつかあります。
              </p>
            </article>
            <article class="vpc-block">
              <h3 id="igw">インターネットゲートウェイ（IGW）</h3>
              <p>VPC図を挿入</p>
              <p>
                VPCをインターネットに接続するための出入口。VPCにアタッチします。<br />
                出入り口がつきましたが、インターネットに接続するにはまだ必要なものがあります。
              </p>
            </article>
            <article class="vpc-block">
              <h3 id="route-table">ルートテーブル（Route Table）</h3>
              <p>
                サブネットの通信経路(ルート)を定義する設定。ルートには、送信先となるIPアドレスの範囲(CIDR)と、通信が経由するリソースをターゲットとして指定します。
              </p>
              <p>ルートテーブルの図を挿入</p>
              <p>
                サブネットをインターネットと接続させる場合、送信先を0.0.0.0./0とし、ターゲットにインターネットゲートウェイを指定します。
              </p>
              <p>ルートテーブルの図を挿入</p>
              <p>
                サブネットに上記のルートテーブルがアタッチされているものは、インターネット接続ができるため、パブリックサブネット呼ばれます。
              </p>
              <p>
                ルートテーブルにはデフォルトで送信先：10.0.0.0/16、ターゲット：localが設定されています。これは、VPCのCIDR範囲内への通信がVPC内部(local)で行われるようにするものであり、削除することはできません。
              </p>
              <ul>
                <li>
                  <strong>パブリックサブネット：</strong
                  >インターネットとの通信が可能なサーバー向け（例：Webサーバー）
                </li>
                <li>
                  <strong>プライベートサブネット：</strong
                  >外部アクセス不可。内部処理向け（例：DB）
                </li>
              </ul>
            </article>
            <article class="vpc-block">
              <h3 id="nat-gateway">NAT Gateway</h3>
              <p>
                プライベートサブネットのインスタンスが外部と通信するために必要なリソースです。
              </p>
              <p>NAT Gatewayの構成図</p>
              <p>
                NAT
                Gatewayを使用することで、プライベートサブネット内のインスタンスはインターネットへのアウトバウンド通信が可能になります。インバウンド通信はできません。
              </p>
            </article>

            <article class="vpc-block">
              <h3 id="sg">セキュリティグループ（SG）</h3>
              <p>
                EC2など、インスタンスレベルで動作するファイアウォールです。<br />
                通信のルール（インバウンドとアウトバウンド）を設定し、どんな通信を許可するかを決めます。<br />
                具体的には、「どんな通信か（プロトコルやポート番号）」と「どこから・どこへの通信か（CIDRや他のセキュリティグループ）」を指定します。<br />
              </p>
              <p>セキュリティグループの参考画面の図</p>
              <p>
                上の図ではインバウンドルールで自宅のIPアドレスからSSH接続を許可しています。
              </p>
              <p>
                セキュリティグループはステートフルという特徴があります。インバウンド通信を許可すると、アウトバウンドの許可ルールがない場合でも、応答は自動的に許可されます。逆も同様です。ただ自動許可されるのは応答に限ります。
              </p>
            </article>
            <article class="vpc-block">
              <h3 id="nacl">ネットワークACL（NACL）</h3>
              <p>
                サブネット単位でアクセス制御をします。<br />
                インバウンドルールとアウトバウンドルールを設定します。<br />
                許可と拒否の両方の設定ができます。<br />
                ステートレスであり、応答通信が必要な場合インバウンドルールとアウトバウンドルールの両方に許可ルールを設定する必要があります。<br />
              </p>
              <p>デフォルトネットワークACLの参考図</p>
              <p>
                デフォルトでは全ての通信が許可されている状態です。<br />
                ルール番号が小さいものから順に評価され、最初にマッチしたルールが適用されます。<br />
                ルール番号 *
                は暗黙のDenyと呼ばれ、削除することできず、何もルールを設定しない場合は全ての通信が拒否される仕組みになっています。<br />
              </p>
            </article>

            <article class="vpc-block">
              <h3 id="sg-vs-nacl">SGとNACLの違い</h3>
              <table>
                <thead>
                  <tr>
                    <th>項目</th>
                    <th>セキュリティグループ</th>
                    <th>ネットワークACL</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>適用単位</td>
                    <td>EC2インスタンス</td>
                    <td>サブネット</td>
                  </tr>
                  <tr>
                    <td>通信の状態</td>
                    <td>ステートフル</td>
                    <td>ステートレス</td>
                  </tr>
                  <tr>
                    <td>許可・拒否</td>
                    <td>許可のみ</td>
                    <td>許可・拒否両方</td>
                  </tr>
                </tbody>
              </table>
            </article>

            <article class="vpc-block">
              <h3 id="az">アベイラビリティゾーン（AZ）</h3>
              <p>
                リージョン内の物理的に分離されたデータセンター群。AZ単位でサブネットを配置することで、冗長構成と高可用性を実現できます。
              </p>
              <p>AZの構成図</p>
            </article>
            <article class="vpc-block">
              <h3 id="multi-vpc">マルチVPC</h3>
              <p>
                数のVPCを連携させて、それぞれのVPCが持つネットワークリソースを共有したり、相互に通信できるようにする仕組み。<br />
                VPCを用途や部門ごとに分け、VPCピアリングやTransit
                Gatewayで接続することで、大規模なネットワーク設計が可能です。
              </p>
            </article>
          </section>
          <section id="vpc-hands-on">
            <h2 id="vpc-hands-on">2. VPCハンズオン</h2>

            <p>
              このハンズオンでは、EC2インスタンスを配置するための最小構成のVPCを作成します。パブリックサブネットを1つ持ち、インターネット接続が可能な構成を用意します。
            </p>

            <h3>構成概要</h3>
            <ul>
              <li>VPC（10.0.0.0/16）</li>
              <li>パブリックサブネット（10.0.1.0/24）</li>
              <li>インターネットゲートウェイ</li>
              <li>ルートテーブル（0.0.0.0/0 → IGW）</li>
              <li>セキュリティグループ（SSH: 22番ポートを自分のIPから許可）</li>
            </ul>

            <h3>設定手順</h3>
            <ol>
              <li>VPC作成（10.0.0.0/16）</li>
              <li>サブネット作成（10.0.1.0/24）</li>
              <li>インターネットゲートウェイ（IGW）作成、VPCへアタッチ</li>
              <li>ルートテーブル作成、ルート(0.0.0.0/0 → IGW)の設定</li>
              <li>ルートテーブルのサブネットへの関連付け</li>
              <li>SSH接続を許可するセキュリティグループの作成</li>
            </ol>

            <h3 id="vpc-create">VPC作成（10.0.0.0/16）</h3>
            <ol>
              <li>
                <strong>AWSマネジメントコンソールで「VPC」を開く</strong><br />

                <ul>
                  <li>「VPC」を検索し、選択</li>
                  <img
                    src="../image/session/2/vpc/1-search.png"
                    alt="VPCサービスを検索して選択するAWSマネジメントコンソールの画面"
                    class="img-w800"
                  />
                  <li>
                    VPCダッシュボードが表示され、関連するリソース一覧が確認できる<br />その中から「VPC」をクリック
                  </li>
                  <img
                    src="../image/session/2/vpc/2-dashboard.png"
                    alt="VPCダッシュボードでVPCリソース一覧を表示している画面"
                    class="img-w800"
                  />
                  <li>VPCのリソース画面が表示される<br /></li>
                  <img
                    src="../image/session/2/vpc/3-console.png"
                    alt="VPCリソース一覧画面（VPCの詳細が表示されている画面）"
                    class="img-w800"
                  />
                  <p>
                    ※
                    赤線のフィルターは皆さんの画面には表示されなくて大丈夫です。画像に関係のないリソースを含めないよう使用しています
                  </p>
                </ul>
              </li>
              <li>
                <strong>デフォルトVPCの削除</strong><br />
                <p>
                  デフォルトVPCは自動で作成されるVPCですが、ハンズオンでは新しいVPCを作成するために削除します。
                </p>
                <ul>
                  <li>
                    「アクション」から「VPCの削除」を選択<br />※
                    「デフォルトVPCを作成」から元に戻すことができます
                  </li>
                  <img
                    src="../image/session/2/vpc/4-delete-default.png"
                    alt="VPC一覧画面でデフォルトVPCを選択し、アクションからVPCの削除を選ぶ操作画面"
                    class="img-w800"
                  />
                  <li>
                    確認ダイアログが開きます<br />チェックを入れ、「デフォルトVPCの削除」を入力し削除<br />※
                    関連するサブネットやIGWなどのリソースも自動で削除されます
                  </li>
                  <img
                    src="../image/session/2/vpc/5-delete-default2.png"
                    alt="デフォルトVPC削除の確認ダイアログでチェックと入力欄に値を入れて削除ボタンを押す画面"
                    class="img-w800"
                  />
                </ul>
              </li>
              <li>
                <strong>新しいVPCの作成</strong><br />
                <ul>
                  <li>「VPCを作成」を押す</li>
                  <img
                    src="../image/session/2/vpc/6-create.png"
                    alt="VPC作成画面で新規作成ボタンを押す操作画面"
                    class="img-w800"
                  />
                  <li>
                    VPCの設定をします<br />名前タグ : 任意(session2-vpcなど)<br />IPv4
                    CIDRブロック : 10.0.0.0/16<br />
                  </li>
                  <img
                    src="../image/session/2/vpc/7-create.png"
                    alt="VPC作成フォームで名前タグとCIDRを入力する画面"
                    class="img-w800"
                  />
                  <li>「VPCを作成」を押す</li>
                  <img
                    src="../image/session/2/vpc/8-launch.png"
                    alt="VPC作成後、VPC一覧に新しいVPCが表示されている画面"
                    class="img-w800"
                  />
                  <li>
                    作成されたVPCを確認。「アクション」から「VPC設定を編集」を選択
                  </li>
                  <img
                    src="../image/session/2/vpc/9-dnsname.png"
                    alt="VPC一覧からVPC設定を編集する操作画面"
                    class="img-w800"
                  />
                  <li>「DNSホスト名を有効化」にチェックを入れ、保存</li>
                  <img
                    src="../image/session/2/vpc/10-dnsname2.png"
                    alt="VPC設定編集画面でDNSホスト名を有効化するチェックボックスにチェックを入れる画面"
                    class="img-w800"
                  />
                </ul>
              </li>
            </ol>

            <h3 id="subnet-create">サブネット作成（10.0.1.0/24）</h3>
            <ol>
              <li>
                <strong>サブネット作成画面を開く</strong><br />
                <ul>
                  <li>
                    左メニューから「サブネット」を選択し、「サブネットを作成」を押す
                  </li>
                  <img
                    src="../image/session/2/subnet/1-console.png"
                    alt="VPCダッシュボードでサブネットメニューを選択し、サブネット作成ボタンを押す画面"
                    class="img-w800"
                  />
                </ul>
              </li>
              <li>
                <strong>サブネットの設定</strong><br />
                <ul>
                  <li>
                    先ほど作成したVPCを選択。その中にサブネットが作成されます。
                  </li>
                  <img
                    src="../image/session/2/subnet/2-create.png"
                    alt="サブネット作成フォームでVPCを選択する画面"
                    class="img-w800"
                  />
                  <li>サブネットの設定内容を指定</li>
                  サブネット名 : 任意（例 : session2-subnet)<br />アベイラビリティゾーン
                  : ap-northeast-1a<br />IPv4 CIDRブロック : 10.0.1.0/24
                  <img
                    src="../image/session/2/subnet/3-create.png"
                    alt="サブネット作成フォームでサブネット名・AZ・CIDRを入力する画面"
                    class="img-w800"
                  />
                  <li>「サブネットを作成」を押す</li>
                  <img
                    src="../image/session/2/subnet/4-launch.png"
                    alt="サブネット作成後、サブネット一覧に新しいサブネットが表示されている画面"
                    class="img-w800"
                  />
                  <li>
                    作成したサブネットを選択し、内容を確認<br />
                    ・利用可能なIPアドレスは256ではなく、251になります<br />
                    ・「パブリックIPv4アドレスを自動割り当て」はデフォルトで無効化されています。次のステップで有効化します。
                  </li>
                  <img
                    src="../image/session/2/subnet/5-check-ip.png"
                    alt="サブネット詳細画面で利用可能なIPアドレスやパブリックIPv4割り当て状況を確認する画面"
                    class="img-w800"
                  />
                </ul>
              </li>
              <li>
                <strong
                  >作成したサブネットの自動割り当てパブリックIPを有効化</strong
                ><br />
                <ul>
                  <li>
                    作成したサブネットを選択し、「アクション」から「サブネットの設定を編集」に進む
                  </li>
                  <img
                    src="../image/session/2/subnet/6-enable-publicip.png"
                    alt="サブネット一覧からサブネットの設定を編集する操作画面"
                    class="img-w300"
                  />
                  <li>
                    「パブリック IPv4
                    アドレスの自動割り当てを有効化」にチェックを入れ保存
                  </li>
                  <img
                    src="../image/session/2/subnet/7-enable-publicip2.png"
                    alt="サブネット設定編集画面で自動割り当てパブリックIPを有効化するチェックボックスにチェックを入れる画面"
                    class="img-w800"
                  />
                </ul>
              </li>
            </ol>

            <h3 id="igw-create">インターネットゲートウェイ（IGW）作成、VPCへアタッチ</h3>
            <ol>
              <li>
                <strong>インターネットゲートウェイの作成画面を開く</strong
                ><br />
                <ul>
                  <li>
                    左メニューから「インターネットゲートウェイ」を選択し、「インターネットゲートウェイの作成」を押す
                  </li>
                  <img
                    src="../image/session/2/igw/1-console.png"
                    alt="インターネットゲートウェイ一覧画面で作成ボタンを押す操作画面"
                    class="img-w800"
                  />
                </ul>
              </li>
              <li>
                <strong>インターネットゲートウェイの設定</strong><br />
                <ul>
                  <li>
                    名前タグに任意の名前（例:
                    session2-igw）を入力し、「インターネットゲートウェイの作成」を押す
                  </li>
                  <img
                    src="../image/session/2/igw/2-create.png"
                    alt="インターネットゲートウェイ作成フォームで名前タグを入力する画面"
                    class="img-w800"
                  />
                </ul>
              </li>
              <li>
                <strong>作成したIGWをVPCにアタッチ</strong><br />
                <ul>
                  <li>
                    作成直後は「Detached」状態なので、「アクション」から「VPCにアタッチ」に進む
                  </li>
                  <img
                    src="../image/session/2/igw/3-attach.png"
                    alt="IGW詳細画面でアクションからVPCにアタッチを選択する画面"
                    class="img-w800"
                  />
                  <li>
                    アタッチ先のVPC（例:
                    session2-vpc）を選択し、「インターネットゲートウェイのアタッチ」を押す
                  </li>
                  <img
                    src="../image/session/2/igw/4-attach.png"
                    alt="VPC選択画面でVPCを選びアタッチする操作画面"
                    class="img-w800"
                  />
                  <li>
                    画面上部に「VPCにアタッチしました」と緑色の通知が表示されれば完了
                  </li>
                </ul>
              </li>
            </ol>

            <h3 id="rtb-create">ルートテーブル作成、ルート(0.0.0.0/0 → IGW) の設定</h3>
            <ol>
              <li>
                <strong>ルートテーブルの作成画面を開く</strong><br />
                <ul>
                  <li>
                    左メニューから「ルートテーブル」を選択し、「ルートテーブルの作成」に進む
                  </li>
                  <img
                    src="../image/session/2/rtb/1-console.png"
                    alt="ルートテーブル一覧画面で作成ボタンを押す操作画面"
                    class="img-w800"
                  />
                </ul>
              </li>
              <li>
                <strong>ルートテーブルの作成</strong><br />
                <ul>
                  <li>
                    任意の名前（例:
                    session2-rtb）を入力し、VPCは作成済みのVPC（session2-vpcなど）を選択、「ルートテーブルを作成」ボタンを押す
                  </li>
                  <img
                    src="../image/session/2/rtb/2-create.png"
                    alt="ルートテーブル作成フォームで名前タグとVPCを選択する画面"
                    class="img-w800"
                  />
                </ul>
              </li>
              <li>
                <strong>ルート(0.0.0.0/0 → IGW)の追加</strong><br />
                <ul>
                  <li>
                    作成したルートテーブルを選択し、「ルート」タブから「ルートを編集」をクリック
                  </li>
                  <img
                    src="../image/session/2/rtb/3-result.png"
                    alt="ルートテーブル詳細画面でルートの編集を選択する画面"
                    class="img-w800"
                  />
                  <li>「ルートを追加」ボタンを押す<br /></li>
                  <img
                    src="../image/session/2/rtb/4-edit-route.png"
                    alt="ルート追加画面で0.0.0.0/0とIGWを指定する操作画面"
                    class="img-w800"
                  />
                  <li>
                    追加したルートに以下の設定をし、「変更を保存」を押す<br />

                    ・送信先: 0.0.0.0/0
                    <br />
                    ・ターゲット:
                    「インターネットゲートウェイ」を選択。選択後に「igw-」というボックスが表示されるので、クリックし作成済みのIGW（session2-igwなど）を選択<br />
                  </li>
                  <img
                    src="../image/session/2/rtb/5-edit-route.png"
                    alt="ルートテーブルに0.0.0.0/0→IGWが追加されたことを確認する画面"
                    class="img-w800"
                  />
                  <li>ルートに0.0.0.0/0 → IGWの行が追加されていればOK</li>
                  <img
                    src="../image/session/2/rtb/6-edit-result.png"
                    alt="ルートテーブルに0.0.0.0/0→IGWが追加されたことを確認する画面"
                    class="img-w800"
                  />
                </ul>
              </li>
            </ol>
            <h3 id="rtb-attach">ルートテーブルのサブネットへの関連付け</h3>
            <ol>
              <li>
                <strong>サブネットの関連付け編集画面を開く</strong><br />
                <ul>
                  <li>
                    作成したルートテーブルを選択し、「サブネットの関連付け」タブをクリック、「サブネットの関連付けを編集」を押す
                  </li>
                  <img
                    src="../image/session/2/rtb/7-attach.png"
                    alt="ルートテーブル詳細画面でサブネットの関連付けタブを選択する画面"
                    class="img-w800"
                  />
                </ul>
              </li>
              <li>
                <strong>関連付けるサブネットの選択</strong><br />
                <ul>
                  <li>
                    作成したサブネット（例:
                    session2-subnet）にチェックを入れ、「保存」を押す
                  </li>
                  <img
                    src="../image/session/2/rtb/8-attach.png"
                    alt="サブネット選択画面で関連付けたいサブネットにチェックを入れる操作画面"
                    class="img-w800"
                  />
                  <li>
                    明示的なサブネットの関連付け一覧に、選択したサブネットが表示されていればOK
                  </li>
                  <img
                    src="../image/session/2/rtb/9-attach-result.png"
                    alt="ルートテーブルのサブネット関連付け一覧にサブネットが表示されている画面"
                    class="img-w800"
                  />
                </ul>
              </li>
            </ol>
            <h3 id="sg-create">セキュリティグループ(SSH接続許可)の作成</h3>
            <ol>
              <li>
                <strong>セキュリティグループの作成画面を開く</strong><br />
                <ul>
                  <li>
                    左メニューから「セキュリティグループ」を選択し、「セキュリティグループを作成」を押す
                  </li>
                  <img
                    src="../image/session/2/sg/1-console.png"
                    alt="セキュリティグループ一覧画面で作成ボタンを押す操作画面"
                    class="img-w800"
                  />
                </ul>
              </li>
              <li>
                <strong
                  >セキュリティグループの設定、インバウンドルールでSSH(22)を許可</strong
                ><br />
                <ul>
                  <li>
                    セキュリティグループ名（例:
                    session2-sg）を入力し、VPCは作成済みのVPC（session2-vpcなど）を選択
                  </li>
                  <li>
                    インバウンドルールの「ルールを追加」ボタンを押し、タイプに「SSH」、ソースに「マイIP」を指定
                  </li>

                  <img
                    src="../image/session/2/sg/2-create.png"
                    alt="セキュリティグループ作成フォームで名前タグとVPCを選択する画面"
                    class="img-w800"
                  />
                  <li>
                    今回アウトバウンドルールはデフォルトの設定(全ての通信が許可)で良いため、変更無し<br />
                    「セキュリティグループを作成」ボタンを押す
                  </li>
                  <img
                    src="../image/session/2/sg/3-create.png"
                    alt="インバウンドルール追加画面でSSH(22)を自分のIPまたは0.0.0.0/0で許可する操作画面"
                    class="img-w800"
                  />
                  <li>インバウンドルールにSSHが表示されていればOK</li>
                  <img
                    src="../image/session/2/sg/4-confirm.png"
                    alt="セキュリティグループのインバウンドルール一覧にSSH(22)が表示されている画面"
                    class="img-w800"
                  />
                </ul>
              </li>
            </ol>
            <p>
              この構成で、次のEC2ハンズオンでパブリックIPからSSH接続が可能になります。
            </p>
          </section>
          <section id="ec2-overview">
            <h2 id="ec2-overview">3. EC2とは？</h2>

            <p>
              EC2（Amazon Elastic Compute
              Cloud）とは、クラウド上に仮想サーバーを作成できるサービスで、OSや性能（CPU・メモリ）を自由に選んで、数分で使い始めることができます。
            </p>
            <p>
              EC2
              インスタンスは、いくつかの構成要素から成り立っており、物理パソコンの部品に例えるとイメージしやすくなります。
            </p>
            <table
              style="border-collapse: collapse; width: 100%; max-width: 800px"
            >
              <thead>
                <tr>
                  <th
                    style="
                      border: 1px solid #ccc;
                      padding: 8px;
                      background: #f2f2f2;
                    "
                  >
                    EC2 の構成要素
                  </th>
                  <th
                    style="
                      border: 1px solid #ccc;
                      padding: 8px;
                      background: #f2f2f2;
                    "
                  >
                    役割
                  </th>
                  <th
                    style="
                      border: 1px solid #ccc;
                      padding: 8px;
                      background: #f2f2f2;
                    "
                  >
                    物理パソコンで例えると
                  </th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td style="border: 1px solid #ccc; padding: 8px">
                    <strong>AMI（Amazon Machine Image）</strong>
                  </td>
                  <td style="border: 1px solid #ccc; padding: 8px">
                    OSや初期ソフトのテンプレート
                  </td>
                  <td style="border: 1px solid #ccc; padding: 8px">
                    OSインストールDVDやリカバリディスク
                  </td>
                </tr>
                <tr>
                  <td style="border: 1px solid #ccc; padding: 8px">
                    <strong>インスタンスタイプ</strong>
                  </td>
                  <td style="border: 1px solid #ccc; padding: 8px">
                    CPU・メモリなどのハードウェア性能
                  </td>
                  <td style="border: 1px solid #ccc; padding: 8px">
                    マザーボードやCPU、メモリ構成
                  </td>
                </tr>
                <tr>
                  <td style="border: 1px solid #ccc; padding: 8px">
                    <strong>EBS（Elastic Block Store）</strong>
                  </td>
                  <td style="border: 1px solid #ccc; padding: 8px">
                    データ保存用の仮想ディスク
                  </td>
                  <td style="border: 1px solid #ccc; padding: 8px">
                    ハードディスクやSSD
                  </td>
                </tr>
                <tr>
                  <td style="border: 1px solid #ccc; padding: 8px">
                    <strong>ENI（Elastic Network Interface）</strong>
                  </td>
                  <td style="border: 1px solid #ccc; padding: 8px">
                    仮想ネットワークインターフェース
                  </td>
                  <td style="border: 1px solid #ccc; padding: 8px">
                    LANポートや無線LANアダプタ
                  </td>
                </tr>
              </tbody>
            </table>

            <p>
              これらの要素を組み合わせて、必要なスペックや機能を持つ仮想サーバーを構築します。<br />
              例えば、Amazon
              LinuxのAMIを選び、t3.microのインスタンスタイプで、EBSに20GBのストレージを割り当てるといった具合です。
            </p>

            <h3 id="ami">AMI（Amazon Machine Image）</h3>
            <p>
              仮想サーバー（EC2インスタンス）を立ち上げる際に使う
              「OSとソフトウェアが含まれたテンプレート」 です。Amazon
              LinuxやWindowsなど、用途に応じたAMIを選んでサーバーを立ち上げます。
            </p>
            <img
              src="../image/session/2/ec2-overview/ami.png"
              alt="AMIの選択画面のスクリーンショット"
              class="img-w800"
            />

            <h3 id="instance-type">インスタンスタイプ</h3>

            <p>
              インスタンスタイプは、EC2 インスタンスの
              CPU、メモリ、ネットワーク性能などのスペック構成を指します。用途に応じて様々なタイプ（例：t3.micro、m5.large
              など）から選べ、コストと性能のバランスを柔軟に調整できます。
            </p>
            <p>
              詳細は
              <a
                href="https://aws.amazon.com/jp/ec2/instance-types/"
                target="_blank"
                rel="noopener noreferrer"
              >
                公式ドキュメント（EC2インスタンスタイプ一覧）
              </a>
              を参照してください。
            </p>

            <h3 id="ebs">EBS（Amazon Elastic Block Store）</h3>
            <p>
              EBSは、EC2
              インスタンスに接続して使う高可用で永続的なブロックストレージサービスです。EBS
              ボリュームは「仮想ハードディスク」のように扱え、OS
              からは通常のローカルディスクとして認識されます。ブロック単位でデータを管理し、自由にファイルシステムを構築できます。
            </p>
            <p>
              OSのインストール先やアプリケーション・データベースの保存に使われ、インスタンス停止後もデータは保持されます。別のインスタンスへ付け替えることも可能です。
            </p>
            <p>
              用途に応じて、読み書き性能（IOPS）やスループットの要件に合わせてストレージの種類や性能を柔軟に選択でき、スナップショットによるバックアップ、暗号化、容量の変更などの機能も備えています。
            </p>

            <img
              src="../image/session/2/ec2-overview/ebs.png"
              alt="ebsの選択画面のスクリーンショット"
              class="img-w800"
            />
            <h3>ENI（Elastic Network Interface）</h3>
            <p>
              ENIは、EC2
              インスタンスにアタッチできる仮想ネットワークインターフェースで、IPアドレスやセキュリティグループなどのネットワーク設定を持ちます。インスタンス間で付け替えたり、複数の
              ENI を使ってネットワークを分離・冗長化することも可能です。
            </p>
            <h3>Elastic IP（EIP）</h3>
            <p>
              Elastic
              IPは、EC2インスタンスに割り当て可能な固定のグローバルIPアドレスです。<br />
              通常、EC2を再起動するとパブリックIPアドレスは変わりますが、EIPを使うことでIPアドレスを固定でき、DNSを変更せずに安定した接続先として利用できます。<br />
              また、EIPはインスタンスから切り離して、他のインスタンスに付け替えることも可能です。
            </p>

            <h3 id="keypair">キーペア</h3>
            <p>
              キーペアは、EC2 インスタンスへ SSH
              接続するための「公開鍵」と「秘密鍵」のセットです。インスタンス作成時に公開鍵を登録し、手元にある秘密鍵（.pem
              ファイル）を使って、安全にリモート接続します。
            </p>
          </section>

          <section id="ec2-hands-on">
            <h2 id="ec2-hands-on">
              4. EC2 ハンズオン：VPC上に仮想サーバーを立てて接続してみよう
            </h2>

            <p>このハンズオンの内容は以下になります。</p>
            <ul>
              <li>VPC上にEC2インスタンスを作成する</li>
              <li>
                自身のPC（ターミナル、コマンドライン）からSSHでEC2インスタンスに接続する
              </li>
            </ul>

            <h3 id="ec2-prereq">前提条件（事前に作成済み）</h3>
            <ul>
              <li>VPC（Virtual Private Cloud）</li>
              <li>パブリックサブネット</li>
              <li>インターネットゲートウェイ（IGW）</li>
              <li>
                EC2用セキュリティグループ（ポート22：SSHを自分のIPに限定して許可）
              </li>
            </ul>

            <h3 id="ec2-create">1. EC2 インスタンスを作成</h3>
            <ol>
              <li>
                AWSマネジメントコンソールから「EC2」のダッシュボードを開く
                <img
                  src="../image/session/2/ec2-hands-on/1.png"
                  alt="EC2サービスを検索して選択するAWSマネジメントコンソールの画面"
                  class="img-w800"
                />
              </li>
              <li>
                「インスタンスを起動」をクリック
                <img
                  src="../image/session/2/ec2-hands-on/2.png"
                  alt="インスタンスを起動ボタンを押す操作画面"
                  class="img-w800"
                />
              </li>
              <li>
                インスタンスの設定をする<br />
                最初に「名前とタグ」に任意の名前(例: session2-ec2)を記入する
                <img
                  src="../image/session/2/ec2-hands-on/3.png"
                  alt="インスタンス作成画面で名前とタグを入力する操作画面"
                  class="img-w800"
                />
              </li>

              <li>
                「AMI」はAmazon Linux
                2023の設定を使用する（デフォルト設定から変更なし）<br />
                <img
                  src="../image/session/2/ec2-hands-on/4.png"
                  alt="AMIの選択画面でAmazon Linux 2023を選ぶ操作画面"
                  class="img-w800"
                />
              </li>
              <li>
                「インスタンスタイプ」はt2.micro(新しい無料プランのアカウントはt3.micro)を使用する（デフォルト設定から変更なし）<br />
                <img
                  src="../image/session/2/ec2-hands-on/5.png"
                  alt="インスタンスタイプの選択画面でt2.microを選ぶ操作画面"
                  class="img-w800"
                />
              </li>
              <li>
                キーペアは「新しいキーペアの作成」を選択<br />
                <img
                  src="../image/session/2/ec2-hands-on/key-pair1.png"
                  alt="キーペアの選択画面で新しいキーペアを作成する操作画面"
                  class="img-w800"
                />
              </li>
              <li>
                プロンプトが表示されるので、以下の内容を入力し、「キーペアを作成」を押す<br />
                ・キーペア名：任意(例 study-key)<br />
                ・キーペアの種類：RSA（推奨）<br />
                ・プライベートキー形式：.pem<br />
                ※
                秘密鍵（.pemファイル）がダウンロードされます。再取得できないので、安全な場所に保管してください<br />

                <img
                  src="../image/session/2/ec2-hands-on/key-pair2.png"
                  alt="キーペアの選択画面で新しいキーペアを作成する操作画面"
                  class="img-w500"
                />
              </li>
              <li>
                作成したキーペアを選択<br />
                ※
                次回からは、新しいキーペアを作らず、作成済みのキーペアを選択することも可能です
                <img
                  src="../image/session/2/ec2-hands-on/key-pair3.png"
                  alt="キーペアの選択画面で新しいキーペアを作成する操作画面"
                  class="img-w800"
                />
              </li>
              <li>
                <strong>ネットワーク設定</strong><br />
                VPC：事前作成済みVPC(session2-vpc)<br />
                サブネット：事前作成済みサブネット(session2-subnet)<br />
                自動割り当てパブリック IP：有効化<br />
                ※
                上記設定になっていない場合、右上の「編集」ボタンから変更できます<br />
                セキュリティグループ：既存のセュリティグループを選択<br />
                共通のセキュリティグループ：事前作済みSG(session2-sg)<br />

                <img
                  src="../image/session/2/ec2-hands-on/network.png"
                  alt="ネットワーク設定画面でVPCとサブネットを選択する操作画面"
                  class="img-w800"
                />
              </li>
              <li>
                ストレージはデフォルト設定を使用。「インスタンスを起動」を押します
                <img
                  src="../image/session/2/ec2-hands-on/storage.png"
                  alt="ストレージ設定画面でデフォルトのストレージを使用する操作画面"
                  class="img-w800"
                />
              </li>
              <li>
                インスタンスの起動が開始されます。「すべてのインスタンスを表示」を押します
                <img
                  src="../image/session/2/ec2-hands-on/launched.png"
                  alt="インスタンス起動確認画面"
                  class="img-w800"
                />
              </li>
              <li>
                作成したインスタンスを確認します<br />
                <img
                  src="../image/session/2/ec2-hands-on/check.png"
                  alt="インスタンス起動確認画面で内容を確認する操作画面"
                  class="img-w800"
                />
              </li>
            </ol>
            <p>
              インスタンスの状態が「実行中」になり、ステータスチェックが「合格」となったら、次のステップに進みます。
            </p>
            <img
              src="../image/session/1/ec211.png"
              alt="EC2インスタンス設定画面"
              class="img-w500"
            />

            <p style="text-align: center; font-size: 0.9em; color: #555">
              保留中の表示
            </p>
            <img
              src="../image/session/1/ec212.png"
              alt="EC2インスタンス設定画面"
              class="img-w500"
            />
            <p style="text-align: center; font-size: 0.9em; color: #555">
              実行中及びステータスチェックの初期化表示
            </p>
            <img
              src="../image/session/1/ec213.png"
              alt="EC2インスタンス設定画面"
              class="img-w500"
            />
            <p style="text-align: center; font-size: 0.9em; color: #555">
              ステータスチェックが合格した状態
            </p>

            <h3 id="ec2-ssh">2. EC2 に SSH 接続</h3>
            <p>1. インスタンスの「パブリック IPv4 アドレス」を確認</p>
            <img
              src="../image/session/2/ec2-hands-on/ip.png"
              alt="EC2インスタンスのパブリックIPアドレスをコピーする操作画面"
              class="img-w800"
            />

            <p>2. .pemファイル(キーペアの秘密鍵)の権限を変更</p>
            <p>【Mac】<br />
              ・ターミナルを開き、cdコマンドで.pemファイルがあるディレクトリに移動します<br>
              ・以下のコマンドを実行して、キーペアファイルの権限を変更します<br />
              　※ <キーペア名>.pemは、実際に作成したキーペアの名前に置き換えてください</br />
                  　(例: study-key.pem)
            </p>
            <div class="code-wrapper">
              <button class="copy-btn" onclick="copyCode()">📋 Copy</button>
              <pre
                class="code-block"
              ><code>chmod 400 &lt;キーペア名&gt;.pem</code></pre>
            </div>
            <p><br></p>
            <p>
              【Windows】<br />
              ・ターミナルを開き、cdコマンドで.pemファイルがあるディレクトリに移動します<br>
              ・以下の二つのコマンドを実行して、キーペアファイルの権限を変更します<br />
              
              　※ <キーペア名>.pemは、実際に作成したキーペアの名前に置き換えてください</br />
                  　(例: study-key.pem)
            </p>
            <div class="code-wrapper">
              <button class="copy-btn" onclick="copyCode()">📋 Copy</button>
              <pre
                class="code-block"
              ><code>icacls &lt;キーペア名&gt;.pem /inheritance:r</code></pre>
            </div>
            <div class="code-wrapper">
              <button class="copy-btn" onclick="copyCode()">📋 Copy</button>
              <pre
                class="code-block"
              ><code>icacls &lt;キーペア名&gt;.pem /grant:r "$($env:USERNAME):(R)"</code></pre>
            </div>
            <p><br></p>
            <p>
                3. SSH
                接続コマンドを実行し、EC2インスタンスに接続</p>
            <p>
              以下のコマンドを実行します
            </p>
            
            <div class="code-wrapper">
              <button class="copy-btn" onclick="copyCode()">📋 Copy</button>
              <pre
                class="code-block"
              ><code>ssh -i &lt;キーペア名&gt;.pem ec2-user@&lt;パブリックIPアドレス&gt;</code></pre>
            </div>
            <p>
              ※ <パブリックIPアドレス>は、EC2のIPアドレスに置き換えてください<br />(例: ssh -i study-key.pem ec2-user@152.30.0.1)<br />

              ※ 接続時に「Are you sure you want to continue connecting (yes/no)?」と聞かれた場合は、yesと入力してEnterを押してください
            </p>
            <p>
              以下のように表示されれば、接続成功です
            </p>
            <img
              src="../image/session/2/ec2-hands-on/ssh.png"
              alt="SSH接続成功の画面"
              class="img-w800"
            />
            <p>
              SSH接続後は、ユーザー名とホスト名が変わります<br />
              例: [ec2-user@ip-10-0-0-37 ~] <br />
              ec2-userはEC2インスタンスのデフォルトユーザー名です<br /> 
              ip-10-0-0-37は、作成したEC2インスタンスのプライベートIPアドレスになります<br />

            </p>
            

            <h3 id="ec2-hello">3. "Hello World" を表示</h3>

            <p>SSH接続した状態で、以下のコマンドを実行します</p>
            <div class="code-wrapper">
              <button class="copy-btn" onclick="copyCode()">📋 Copy</button>
              <pre
                class="code-block"
              ><code>echo "Hello World"</code></pre>
            </div>
            <p>
              以下のように表示されれば、成功です
            </p>
            <img
              src="../image/session/2/ec2-hands-on/hello-world.png"
              alt="Hello Worldの表示画面"
              class="img-w600"
            />
            <p>
              これで、EC2インスタンス上でコマンドを実行できるようことが確認できました<br />
              同様の手順で、インスタンスの中にWebサーバーを立てたり、アプリケーションをデプロイしたりしていくことができます
            </p>
            <p>
              🎉 これで仮想サーバー（EC2）の立ち上げとSSH接続のハンズオンは完了です！
            </p>
            <h3 id="cleanup">後片付け</h3>
            <p>セッションで作成したリソースは必ず削除をお願いします<br />
              削除方法の確認のためだけでなく、不要な課金や、セキュリティリスク（安全な設計でない場合）の発生防止のために削除を行います<br />
              
            </p>
            <h3 id="delete-procedure">削除手順</h3>
            <ol>
              <li>
                削除するEC2インスタンスを選択し、「インスタンスの状態」を選択し、「インスタンスを終了」を選択します<br />
              </li>
              <img
                src="../image/session/1/delete-ec2-1.png"
                alt="EC2インスタンス設定画面"
                class="img-w800"
              />
              <li>確認画面が表示されるので、終了を押します<br /></li>
              <img
                src="../image/session/1/delete-ec2-2.png"
                alt="EC2インスタンス設定画面"
                class="img-w800"
              />
              <li>
                削除中はインスタンスの状態が「シャットダウン」になります<br />
              </li>

              <img
                src="../image/session/1/delete-ec2-3.png"
                alt="EC2インスタンス設定画面"
                class="img-w800"
              />
              <li>
                少し待ち更新ボタンを押すと、インスタンスの状態が「終了済み」になります<br />
                これでEC2インスタンスの削除は完了です<br />
              </li>

              <img
                src="../image/session/1/delete-ec2-4.png"
                alt="EC2インスタンス設定画面"
                class="img-w800"
              />
            </ol>
          </section>
          <section id="end">
            <h3>おわりに</h3>
            <p>
              今回のセッションでは、AWSのVPCとEC2の基本的な概念と、実際にVPCを構築し、EC2インスタンスを立ち上げてSSH接続するまでの流れを体験しました。<br />
              次回はIAM(Identity and Access
              Management)の基礎理解と、リレーショナルデータベースサービスであるRDS/Auroraの学習およびハンズオンを行います。
            </p>
          </section>
        </div>
         
        <nav class="toc">
          <h3>目次</h3>
            <ul>
              <li><a href="#introduction">はじめに</a></li>
              <li>
                <a href="#vpc-overview">1. VPCと構成要素</a>
                <ul>
                  <li><a href="#vpc">VPC</a></li>
                  <li><a href="#subnet">サブネット</a></li>
                  <li><a href="#igw">インターネットゲートウェイ</a></li>
                  <li><a href="#route-table">ルートテーブル</a></li>
                  <li><a href="#nat-gateway">NAT Gateway</a></li>
                  <li><a href="#sg">セキュリティグループ</a></li>
                  <li><a href="#nacl">ネットワークACL</a></li>
                  <li><a href="#sg-vs-nacl">SGとNACLの違い</a></li>
                  <li><a href="#az">アベイラビリティゾーン</a></li>
                  <li><a href="#multi-vpc">マルチVPC</a></li>
                </ul>
              </li>
              <li>
                <a href="#vpc-hands-on">2. VPCハンズオン</a>
                <ul>
                  <li><a href="#vpc-create">VPC作成</a></li>
                  <li><a href="#subnet-create">サブネット作成</a></li>
                  <li><a href="#igw-create">IGW作成・アタッチ</a></li>
                  <li><a href="#rtb-create">ルートテーブル作成・設定</a></li>
                  <li><a href="#rtb-attach">ルートテーブル関連付け</a></li>
                  <li><a href="#sg-create">セキュリティグループ作成</a></li>
                </ul>
              </li>
              <li>
                <a href="#ec2-overview">3. EC2とは？</a>
                <ul>
                  <li><a href="#ami">AMI</a></li>
                  <li><a href="#instance-type">インスタンスタイプ</a></li>
                  <li><a href="#ebs">EBS</a></li>
                  <li><a href="#keypair">キーペア</a></li>
                </ul>
              </li>
              <li>
                <a href="#ec2-hands-on">4. EC2ハンズオン</a>
                <ul>
                  <li><a href="#ec2-prereq">前提条件</a></li>
                  <li><a href="#ec2-create">EC2インスタンス作成</a></li>
                  <li><a href="#ec2-ssh">SSH接続</a></li>
                  <li><a href="#ec2-hello">Hello World表示</a></li>
                </ul>
              </li>
              <li><a href="#cleanup">後片付け</a></li>
              <li><a href="#end">おわりに</a></li>
            </ul>
        </nav>
      </div>
    </main>

    <footer>
      &copy; 2025 勉強会 for AWS licensed under GPLv3 & CC BY-SA 4.0.
    </footer>
    <script src="../common/script.js"></script>
  </body>
</html>
